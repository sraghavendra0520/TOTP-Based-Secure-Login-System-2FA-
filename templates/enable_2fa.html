<!-- with 2FA TOTP -->

<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Enable 2FA</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
<div class="dashboard-box">
    <h2>Enable Two-Factor Authentication</h2>

    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        <ul>
        {% for category, msg in messages %}
          <li>{{ msg }}</li>
        {% endfor %}
        </ul>
      {% endif %}
    {% endwith %}

    <div class="qr-box">
        <img src="{{ qr_data }}" alt="QR Code">
    </div>

    <p class="center">Manual secret: <strong>{{ secret }}</strong></p>

    <form method="post" autocomplete="off">
        <label for="token">Enter the 6-digit code from your app:</label>
        <input id="token" type="text" name="token" placeholder="123456" required>
        <button type="submit">Verify & Enable</button>
    </form>

    <p class="center"><a href="{{ url_for('dashboard') }}">Back to Dashboard</a></p>
</div>
</body>
</html>
